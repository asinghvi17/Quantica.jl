<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Observables · Quantica.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://pablosanjose.github.io/Quantica.jl/tutorial/observables/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.svg" alt="Quantica.jl logo"/><img class="docs-dark-only" src="../../assets/logo-dark.svg" alt="Quantica.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Quantica.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorial</span><ul><li><a class="tocitem" href="../tutorial/">Welcome</a></li><li><a class="tocitem" href="../glossary/">Glossary</a></li><li><a class="tocitem" href="../lattices/">Lattices</a></li><li><a class="tocitem" href="../models/">Models</a></li><li><a class="tocitem" href="../hamiltonians/">Hamiltonians</a></li><li><a class="tocitem" href="../bandstructures/">Bandstructures</a></li><li><a class="tocitem" href="../greenfunctions/">GreenFunctions</a></li><li class="is-active"><a class="tocitem" href>Observables</a><ul class="internal"><li><a class="tocitem" href="#Local-density-of-states-(LDOS)"><span>Local density of states (LDOS)</span></a></li><li><a class="tocitem" href="#Current"><span>Current</span></a></li><li><a class="tocitem" href="#Transmission"><span>Transmission</span></a></li><li><a class="tocitem" href="#Conductance"><span>Conductance</span></a></li><li><a class="tocitem" href="#Josephson"><span>Josephson</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../examples/">Examples</a></li><li><a class="tocitem" href="../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorial</a></li><li class="is-active"><a href>Observables</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Observables</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/pablosanjose/Quantica.jl/blob/master/docs/src/tutorial/observables.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Observables"><a class="docs-heading-anchor" href="#Observables">Observables</a><a id="Observables-1"></a><a class="docs-heading-anchor-permalink" href="#Observables" title="Permalink"></a></h1><p>We are almost at our destination now. We have defined a <code>Lattice</code>, a <code>Model</code> for our system, we applied the <code>Model</code> to the <code>Lattice</code> to obtain a <code>Hamiltonian</code> or a <code>ParametricHamiltonian</code>, and finally, after possibly attaching some contacts to outside reservoirs and specifying a <code>GreenSolver</code>, we obtained a <code>GreenFunction</code>. It is now time to use the <code>GreenFunction</code> to obtain some observables of interest.</p><p>Currently, we have the following observables built into Quantica.jl (with more to come in the future)     - <code>ldos</code>: computes the local density of states at specific energy and sites     - <code>current</code>: computes the local current density along specific directions, and at specific energy and sites     - <code>transmission</code>: computes the total transmission between contacts     - <code>conductance</code>: computes the differential conductance <code>dIᵢ/dVⱼ</code> between contacts <code>i</code> and <code>j</code>     - <code>josephson</code>: computes the supercurrent and the current-phase relation through a given contact in a superconducting system</p><p>See the corresponding docstrings for full usage instructions. Here we will present some basic examples</p><h2 id="Local-density-of-states-(LDOS)"><a class="docs-heading-anchor" href="#Local-density-of-states-(LDOS)">Local density of states (LDOS)</a><a id="Local-density-of-states-(LDOS)-1"></a><a class="docs-heading-anchor-permalink" href="#Local-density-of-states-(LDOS)" title="Permalink"></a></h2><p>Let us compute the LDOS in a cavity like in the previous section. Instead of computing the Green function between a contact to an arbitrary point, we can construct an object <code>ρ = ldos(g(ω))</code> without any contacts. By using a small imaginary part in <code>ω</code>, we broaden the discrete spectrum, and obtain a finite LDOS. Then, we can pass <code>ρ</code> directly as a site shader to <code>qplot</code></p><pre><code class="language-julia hljs">julia&gt; h = LP.square() |&gt; onsite(4) - hopping(1) |&gt; supercell(region = r -&gt; norm(r) &lt; 40*(1+0.2*cos(5*atan(r[2],r[1]))));

julia&gt; g = h|&gt; greenfunction;

julia&gt; ρ = ldos(g(0.1 + 0.001im))
LocalSpectralDensitySolution{Float64} : local density of states at fixed energy and arbitrary location
  kernel   : LinearAlgebra.UniformScaling{Bool}(true)

julia&gt; qplot(h, hide = :hops, sitecolor = ρ, siteradius = ρ, minmaxsiteradius = (0, 2), sitecolormap = :balance)</code></pre><img src="../../assets/star_shape_ldos.png" alt="LDOS" width="400" class="center"/><p>Note that <code>ρ[sites...]</code> produces a vector with the LDOS at sites defined by <code>siteselector(; sites...)</code> (<code>ρ[]</code> is the ldos over all sites). We can also define a <code>kernel</code> to be traced over orbitals to obtain the spectral density of site-local observables (see <code>diagonal</code> slicing in the preceding section).</p><h2 id="Current"><a class="docs-heading-anchor" href="#Current">Current</a><a id="Current-1"></a><a class="docs-heading-anchor-permalink" href="#Current" title="Permalink"></a></h2><p>A similar computation can be done to obtain the current density, using <code>J = current(g(ω), direction = missing)</code>. This time <code>J[sᵢ, sⱼ]</code> yields a sparse matrix of current densities along a given direction for each hopping (or the current norm if <code>direction = missing</code>). Passing <code>J</code> as a hopping shader yields the equilibrium current in a system. In the above example we can add a magnetic flux to make this current finite</p><pre><code class="language-julia hljs">julia&gt; h = LP.square() |&gt; supercell(region = r -&gt; norm(r) &lt; 40*(1+0.2*cos(5*atan(r[2],r[1])))) |&gt; onsite(4) - @hopping((r, dr; B = 0.1) -&gt; cis(B * dr[1] * r[2]));

julia&gt; g = h |&gt; greenfunction;

julia&gt; J = current(g(0.1; B = 0.01))
CurrentDensitySolution{Float64} : current density at a fixed energy and arbitrary location
  charge      : LinearAlgebra.UniformScaling{Int64}(-1)
  direction   : missing

julia&gt; qplot(h, siteradius = 0.08, sitecolor = :black, siteoutline = 0, hopradius = J, hopcolor = J, minmaxhopradius = (0, 2), hopcolormap = :balance, hopdarken = 0)</code></pre><img src="../../assets/star_shape_current.png" alt="Current density with magnetic flux" width="400" class="center"/><div class="admonition is-info"><header class="admonition-header">Remember to construct supercell before applying position-dependent fields</header><div class="admonition-body"><p>Note that we built the supercell before applying the model with the magnetic flux. Not doing so would make the gauge field be repeated in each unit cell when expanding the supercell. This was mentioned in the section on Hamiltonians, and is a common mistake when modeling systems with position dependent fields.</p></div></div><h2 id="Transmission"><a class="docs-heading-anchor" href="#Transmission">Transmission</a><a id="Transmission-1"></a><a class="docs-heading-anchor-permalink" href="#Transmission" title="Permalink"></a></h2><p>The transmission <code>Tᵢⱼ</code> from contact <code>j</code> to contact <code>i</code> can be computed using <code>transmission</code>. This function accepts a <code>GreenSlice</code> between the contact. Let us recover the four-terminal setup of the preceding section, but let&#39;s make it bigger this time</p><pre><code class="language-julia hljs">julia&gt; hcentral = LP.square() |&gt; onsite(4) - hopping(1) |&gt; supercell(region = RP.circle(100) | RP.rectangle((202, 50)) | RP.rectangle((50, 202)))

julia&gt; glead = LP.square() |&gt; onsite(4) - hopping(1) |&gt; supercell((1, 0), region = r -&gt; abs(r[2]) &lt;= 50/2) |&gt; greenfunction(GS.Schur(boundary = 0));

julia&gt; Rot = r -&gt; SA[0 -1; 1 0] * r;  # 90º rotation function

julia&gt; g = hcentral |&gt;
           attach(glead, region = r -&gt; r[1] ==  101) |&gt;
           attach(glead, region = r -&gt; r[1] == -101, reverse = true) |&gt;
           attach(glead, region = r -&gt; r[2] ==  101, transform = Rot) |&gt;
           attach(glead, region = r -&gt; r[2] == -101, reverse = true, transform = Rot) |&gt;
           greenfunction;

julia&gt; gx1 = sum(abs2, g(0.04)[siteselector(), 1], dims = 2);

julia&gt; qplot(hcentral, hide = :hops, siteoutline = 1, sitecolor = (i, r) -&gt; gx1[i], siteradius = (i, r) -&gt; gx1[i], minmaxsiteradius = (0, 2), sitecolormap = :balance)</code></pre><img src="../../assets/four_terminal_g_big.png" alt="Green function from right lead" width="400" class="center"/><p>It&#39;s apparent from the plot that the transmission from right to left (<code>T₂₁</code> here) at this energy of <code>0.04</code> is larger than from right to top (<code>T₃₁</code>). Is this true in general? Let us compute the two transmissions as a function of energy. To show the progress of the calculation we can use a monitor package, such as <code>ProgressMeter</code></p><pre><code class="language-julia hljs">julia&gt; using ProgressMeter

julia&gt; T₂₁ = transmission(g[2,1]); T₃₁ = transmission(g[3,1]); ωs = subdiv(0, 4, 200);

julia&gt; T₂₁ω = @showprogress [T₂₁(ω) for ω in ωs]; T₃₁ω = @showprogress [T₃₁(ω) for ω in ωs];
Progress: 100%|██████████████████████████████████████████████████████████████| Time: 0:01:05
Progress: 100%|██████████████████████████████████████████████████████████████| Time: 0:01:04

julia&gt; f = Figure(); a = Axis(f[1,1], xlabel = &quot;ω/t&quot;, ylabel = &quot;T(ω)&quot;); lines!(a, ωs, T₂₁ω, label = L&quot;T_{2,1}&quot;); lines!(a, ωs, T₃₁ω, label = L&quot;T_{3,1}&quot;); axislegend(&quot;Transmission&quot;, position = :lt); f</code></pre><img src="../../assets/four_terminal_T.png" alt="Total transmission from right contact" width="400" class="center"/><div class="admonition is-info"><header class="admonition-header">Total transmission vs transmission probability</header><div class="admonition-body"><p>Note that <code>transmission</code> gives the total transmission, which is the sum of the transmission probability from each orbital in the source contact to any other orbital in the drain contact. As such it is not normalized to 1, but to the number of source orbitals. It also gives the local conductance from a given contact in units of <span>$e^2/h$</span> according to the Landauer formula, <span>$G\_j = e^2/h \sum_i T_{ij}(eV)$</span>.</p></div></div><h2 id="Conductance"><a class="docs-heading-anchor" href="#Conductance">Conductance</a><a id="Conductance-1"></a><a class="docs-heading-anchor-permalink" href="#Conductance" title="Permalink"></a></h2><h2 id="Josephson"><a class="docs-heading-anchor" href="#Josephson">Josephson</a><a id="Josephson-1"></a><a class="docs-heading-anchor-permalink" href="#Josephson" title="Permalink"></a></h2></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../greenfunctions/">« GreenFunctions</a><a class="docs-footer-nextpage" href="../../examples/">Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Thursday 12 October 2023 16:18">Thursday 12 October 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
